<!-- Update to ensure content is visible and styled properly -->
<style>
  body {
    font-family: Arial, sans-serif;
    background: #fdf6f0;
    padding: 40px;
    margin: auto;
    max-width: 800px;
  }
  .form-block, .results {
    margin-bottom: 20px;
  }
  .form-block label, .results h4 {
    font-weight: bold;
  }
  input[type="number"] {
    width: 100%;
    padding: 10px;
    font-size: 1rem;
    margin-top: 5px;
  }
  button {
    padding: 10px 20px;
    background: #e65100;
    color: white;
    border: none;
    font-size: 1rem;
    cursor: pointer;
  }
  button:hover {
    background: #bf360c;
  }
  .results span {
    font-weight: normal;
    color: #444;
    margin-left: 10px;
  }
</style>

<!-- Make sure JavaScript runs after DOM loads -->
<script>
  window.onload = () => {
    document.getElementById('calculateBtn').addEventListener('click', () => {
      const get = (id) => Math.max(6, Math.min(120000, parseInt(document.getElementById(id).value)));
      const licenses = Math.max(6, Math.min(55, parseInt(document.getElementById('userLicenses').value)));
      const volume = get('volume');
      const docVolume = get('documentVolume');
      const selectedModules = [...document.querySelectorAll('#moduleCheckboxes input:checked')].map(cb => cb.value);

      const getSlabIndex = (val) => slabs.findIndex(slab => val >= slab.min && val <= slab.max);
      const slabIndex = getSlabIndex(volume);
      const docSlabIndex = getSlabIndex(docVolume);

      let moduleCost = 0;
      selectedModules.forEach(mod => {
        const idx = mod.includes("Document") ? docSlabIndex : slabIndex;
        const units = mod.includes("Document") ? docVolume : volume;
        moduleCost += productPricing[mod][idx] * units;
      });

      const discount = discountRates[selectedModules.length] || (selectedModules.length >= 6 ? 30 : 0);
      const discountedModuleCost = moduleCost * (1 - discount / 100);

      const licensePrice = licenseTiers.find(tier => licenses >= tier.min && licenses <= tier.max)?.price || 60;
      const totalLicenseCost = licensePrice * licenses * 1.1;

      const firstYear = discountedModuleCost + totalLicenseCost;
      const secondYear = discountedModuleCost + (totalLicenseCost * 1.1);
      const perLicense = firstYear / licenses;

      const format = x => "$" + Math.round(x).toLocaleString();
      document.getElementById('moduleCost').textContent = format(discountedModuleCost);
      document.getElementById('totalLicenseCost').textContent = format(totalLicenseCost);
      document.getElementById('firstYearTotal').textContent = format(firstYear);
      document.getElementById('perLicenseCost').textContent = format(perLicense);
      document.getElementById('secondYearTotal').textContent = format(secondYear);
    });
  };
</script>
